# 2026-02-19 Daily Memory

## 00:08-00:15 CST - Dashboard Active Subagents Fix

**Issue:** User reported dashboard shows 0 active subagents for SlackLite even though PL logs show Bob sprint planning.

**Root cause identified:**
- Bob IS spawned as a separate OpenClaw subagent (user was right!)
- `/api/sessions` uses Gateway's `sessions_list` which only returns **top-level agent sessions**, not subagents
- `/api/active-subagents` filtered those sessions, but subagents weren't in the data to begin with
- Subagent sessions exist on disk in `~/.openclaw/agents/*/sessions/` but weren't being read

**Fix applied:**
1. Fixed `project-registry.json`: SlackLite projectId was `null` â†’ `"slacklite"`
2. Rewrote `/api/active-subagents` to directly read from agent session directories on disk instead of relying on Gateway API
3. New logic: Scan `~/.openclaw/agents/*/sessions/sessions.json` â†’ find subagents with matching projectId in label â†’ check transcript age (<30 min) â†’ return active subagents
4. Rebuilt dashboard production build and restarted launchd service

**Result:**
- Dashboard now correctly shows **6 active subagents** for SlackLite:
  - 3Ã— Bob sessions (sprint, deps, stories)
  - 2Ã— John sessions (fix-prd-epics, readiness-v2)
  - 1Ã— Winston session (fix-arch)

## SlackLite Status
- State: in-progress (Phase 1)
- PL Session: agent:project-lead:project-slacklite (active)
- Current: Bob sprint planning (internal agent)
- Gate Check #2: John session (john-readiness-v2-slacklite) actively running, validating remediation fixes
- Waiting on: Gate Check #2 results â†’ if PASS, Bob starts Phase 2 implementation

## Active Work
- SlackLite Phase 1: 1 active subagent (bob-stories-slacklite creating 68 story files)
  - Bob sprint, deps, John gate checks, Winston fix: all completed

## 00:41 CST - Research Lead 8 Complete: Idea Killed (10/10 solutions rejected)

**Problem:** Personal Relationship Management (iOS mobile app)  
**Result:** âŒ Quinn killed all 10/10 qualified solutions â†’ No intake.md created

**Why it failed:**
- 20+ year graveyard: Etacts (YCâ†’Salesforceâ†’killed), Connected (â†’LinkedInâ†’killed), Monaru (YC 2019â†’dead same year)
- Platform barriers: iOS/Android block passive message/call tracking
- Behavioral paradox: Users who need it lack daily discipline to use it
- Free alternatives work: Siri Reminders, calendar notifications
- 75% journaling abandonment within 2 weeks
- Revenue reality: 2-5% freemium conversion (not 12-15%), Y1 ARR <$10K vs $30-50K dev cost

**Quinn's insight:** "Awareness â‰  action. People enjoy complaining about being 'bad friends' but won't pay $48/year to feel worse about it."

**Validation of v3.2 design:**
- âœ… Fallback queue worked (tried all 10 solutions)
- âœ… Kill gate prevented 6-week factory waste on fundamentally unsolvable problem
- âœ… Data-driven decision (graveyard research + platform constraints + economics)
- âœ… No intake.md = no project registry entry = clean exit
  
## 00:22 CST - Active Subagent Detection + Stories File Unification

**Issue 1:** Dashboard showed 6 "active" subagents but 5 had already completed
- Root cause: checked transcript age (<30 min) but transcripts get written to AFTER completion (announce-backs)
- Fix: Check for `.lock` files instead â†’ only sessions with active locks are shown
- Result: Now correctly shows 1 active (bob-stories-slacklite)

**Issue 2:** Code looked for both `stories-parallelization.json` AND `dependency-graph.json`
- Bob only creates `dependency-graph.json` in Phase 1
- Fix: Removed `stories-parallelization.json` fallback, use `dependency-graph.json` only
- Result: Unified to canonical file

## 08:36 CST - SlackLite Status Check (User Escalation)

**Context:** Matt asked for status update, I gave incorrect info ("started 3 hours ago, should be done soon")

**Reality check:**
- Project started: Feb 18 ~23:50 CST (yesterday, ~9 hours ago)
- Sprint progress: **2/68 stories complete (3%)**
  - âœ… Story 1.1: Next.js initialized
  - âœ… Story 1.6: Design system foundation
- **BLOCKED - Critical issues:**
  - Story 1.2 (Firebase config): Security vulnerability - RTDB /users path has NO security rules (workspace isolation bypass) + 4 MAJOR issues
  - Story 1.5 (Vercel setup): Missing GitHub secrets, DNS not configured, deployments returning 401s
- Todo: 64 remaining stories across 11 epics
- Estimated total effort: 102-153 hours

**Mistake:** Read registry `timeline.lastUpdated` (05:11 UTC) and misinterpreted as project start time. Actual start was ~9 hours prior.

**Waiting on:** Project Lead (agent:project-lead:project-slacklite) to resolve blocking security issues in stories 1.2 and 1.5 before auth/messaging work can proceed.

**Lesson:** Always check file timestamps and sprint-status.yaml for ground truth, not just registry timestamps.

## 08:41 CST - Default Compaction Failure Analysis + instinct8 Re-enabled

**Root cause of PL death loop:**
- Single exec command removed `.pnpm-store` â†’ listed hundreds of files in output
- Massive tool result pushed session from <200k to **215k tokens instantly**
- Jumped over the `reserveTokensFloor: 35000` safety buffer in one turn
- Next API call failed with 400 error (215k > 200k limit)
- Session locked - can't respond, can't compact, can't recover

**Why default compaction failed:**
- Only runs **between turns**, not during tool result processing
- Can't prevent single massive tool output from exceeding limit
- Need compaction that runs **during** tool execution, not just after

**Fix applied:**
- Enabled `instinct8-compaction` plugin via `gateway config.patch`
- Plugin triggers at 150k tokens (earlier threshold)
- Can compact **during** tool execution when detecting size issues
- Gateway restarted via SIGUSR1

**Action taken:**
- Sent context refresh message to Project Lead session for slacklite
- Priority: Deploy Vercel to ANY domain (not slacklite.app), then fix RTDB security
- instinct8 plugin should prevent future death loops

## 08:53 CST - Session Recovery Skill Created

**Problem:** Kelly can detect frozen PL sessions but had no way to restart them autonomously.

**Solution created:**
- **Skill:** `skills/factory/session-recovery/` 
- **Script:** `bin/recover-session` - Archives transcript, clears state, sends context refresh
- **Integration:** Updated `HEARTBEAT.md` - auto-recover on stall check if 400 errors detected
- **Docs:** Updated `kelly-router-flow.md` - Session Recovery section added

**How it works:**
1. Kelly detects stalled project (>60 min no updates)
2. Pings PL, waits 5 min
3. If no response: check `sessions_history` for 400 errors
4. If frozen: run recovery script (archive transcript, clear state, refresh)
5. Alert operator: "ðŸ”§ Auto-recovered frozen PL session"

**Architecture:**
- This is a **workaround skill** until OpenClaw core adds `sessions_restart` tool
- Safe: transcripts archived, state loaded from registry, idempotent
- Logged: recovery events written to daily memory

**Future:** Proposal documented in SKILL.md for proper `sessions_restart(sessionKey, reason)` tool in OpenClaw core.
