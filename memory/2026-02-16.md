# 2026-02-16

## Skills Investigation & Reorganization

User reported missing skills from workspace, specifically mentioning:
- skill-creator
- security-audit
- "entire subdirectories missing"

**Investigation findings:**
- Local workspace `/Users/austenallred/clawd/skills/` only ever had factory/utilities/web
- Git history shows only `chrome-relay-driver` was deleted
- Global OpenClaw skills at `/opt/homebrew/lib/node_modules/openclaw/skills/` still exist with 50+ skills
- User was likely thinking of global skills, not local workspace skills

**Resolution:**
1. Established local skills workspace with proper structure
2. Copied essential skills from global OpenClaw installation:
   - skill-creator, coding-agent, github, tmux, things-mac, gog
3. Created custom security-audit skill for factory projects
4. Organized into pipeline phases: build/, plan/, test/

**Final Structure:**
- **build/** - coding-agent, security-audit
- **plan/** - (future planning skills)
- **test/** - tea-smoke-test-web.sh, tea-smoke-test-ios.sh
- **factory/** - memory-system-v2, project-lead-instantiator, session-closer
- **utilities/** - skill-creator, github, gog, tmux, things-mac, web-browser, web-search
- **web/tech-stack/** - firebase-cli, oauth-automation

**Kelly Improver Enhancement:**
- Added "Available Skills" section to kelly-improver's AGENTS.md
- Gave kelly-improver access to skill-creator and other factory improvement skills
- Enables kelly-improver to prototype new skills, audit existing ones, and generate concrete proposals
- Skills: skill-creator, security-audit, coding-agent, github, memory-system-v2, web-browser

**Note:** 
- Memory search was disabled due to OpenAI embeddings quota error
- Global OpenClaw skills kept as reference/backup library
- Local workspace skills take precedence over global skills
- Kelly-improver workspace is separate from main git repo (in ~/.openclaw/workspace-kelly-improver/)

---

## fleai-market v3 Session Terminations (15:22 CST)

### Issue Detected
3 Amelia sessions terminated/crashed without reporting completion:
- E2-S1: Agent Registration API (40+ min runtime)
- E1-S6: Monitoring (Sentry + Axiom) (33+ min runtime)
- E8-S2: Admin Dashboard Overview (27+ min runtime)

**Root cause:** Sessions spawned with OLD harness approach (before Sonnet 4.5 + codex CLI consolidation), ran for extended periods, then disappeared from sessions list without completion report.

**Last successful completion:** E1-S5 (CI/CD) at 14:52 CST (30 minutes ago)

### Recovery Action
**Marked as terminated in project-state.json** (status: "terminated", note added)

**Directive sent to Project Lead:** Respawn all 3 with NEW harness approach:
- Wrapper: `claude-sonnet-4-5` (just updated)
- CLI invocation: `exec` tool with `pty:true` + `workdir`
- Reference spawning-protocol skill for updated Amelia spawn template

**This will be first test of consolidated codex CLI harness under real load.**

### Current Status (15:22 CST)
- **Complete:** 7/67 stories (10%)
- **Terminated:** 3 stories (awaiting respawn)
- **Pending:** 57 stories
- **Active:** 0 (all previous actives terminated)

**Next:** Wait for Project Lead to respawn with new harness, monitor for successful completion or new issues.

---

## Sonnet 4.5 Orchestrator Decision (15:19 CST)

**User decision:** "4.5 will be our main orchestrator then. I like your recommendations for all this."

### Model Strategy Finalized

**All BMAD agents now use Sonnet 4.5 as wrapper:**
- Amelia: Wrapper `claude-sonnet-4-5`, CLI `gpt-5.3-codex`
- Barry: Wrapper `claude-sonnet-4-5`, CLI `gpt-5.3-spark`
- Murat: Wrapper `claude-sonnet-4-5`, CLI `gpt-5.3-codex`

### Changes Applied

**Agent configs updated:**
- `/Users/austenallred/.openclaw/agents/bmad-bmm-amelia/config`
- `/Users/austenallred/.openclaw/agents/bmad-bmm-barry/config`
- `/Users/austenallred/.openclaw/agents/bmad-tea-murat/config`

**Documentation updated:**
- All three AGENTS.md files (Amelia, Barry, Murat)
- coding-agent/SKILL.md (all BMAD Integration sections)
- memory/2026-02-16.md (decision recorded)

**Effect on fleai-market v3:**
- Current terminated sessions will respawn with Sonnet 4.5
- Better orchestration, file management, workflow control
- CLI work still uses Codex 5.3 for quality multi-file implementation

**Architecture:** Sonnet 4.5 orchestrates, Codex/Spark executes.

---

## Codex CLI Harness Systematic Failure (15:23-15:28 CST)

### Issue Discovered

**NEW harness (deployed 15:19-15:23 CST) is systematically failing:**

**Test results from 3 respawned stories:**
1. **E8-S2-v2:** Failed at 15:27 (4 min) - Analysis only, no implementation
2. **E2-S1-v2:** Failed at 15:28 (5 min) - No output, analysis paralysis pattern
3. **E1-S6-v2:** Still active at 15:28 (5 min) - Likely same failure pending

**Failure pattern:**
- exec tool with pty:true + codex CLI invocation
- Codex receives task, analyzes existing code
- Gets stuck in planning phase
- Never writes any files
- Session completes with zero implementation

### Evidence

**What worked (OLD harness):**
- First 7 completions: E1-S1, E1-S2, E1-S3, E1-S4, E1-S5, E6-S3, E8-S1
- Direct file manipulation (Amelia wrote code using write/edit tools)
- All completed successfully with actual code changes

**What failed (NEW harness):**
- E8-S2-v2: 4 min runtime, analysis only
- E2-S1-v2: 5 min runtime, no output
- Pattern: Codex analyzes but doesn't implement

### Root Cause Hypothesis

**exec tool with pty:true may be interfering with codex CLI:**
- Codex expects interactive terminal
- PTY mode may be confusing codex about execution context
- Codex thinks it's in analysis mode, not implementation mode
- Alternative: Command string formatting issue in exec invocation

### Rollback Decision

**Trigger:** If E1-S6-v2 also fails (3/3 systematic failure)

**Plan:** `/Users/austenallred/clawd/ROLLBACK-PLAN-CODEX-HARNESS.md`

**Rollback actions:**
1. Revert Amelia AGENTS.md to direct coding (remove codex CLI harness section)
2. Keep Sonnet 4.5 wrapper (not the problem)
3. Update spawning-protocol skill
4. Respawn 3 stories (v3 iteration) with OLD approach

**OLD approach (proven to work):**
- Direct file manipulation using write/edit tools
- No codex CLI invocation
- Amelia writes code herself
- First 7 stories succeeded this way

### Lesson Learned

**Don't deploy new harness to production project:**
- Test in isolated environment first
- Validate with small story before full deployment
- Have rollback plan ready BEFORE deployment
- Monitor first few stories closely

### Status at 15:28 CST

- ‚úÖ Rollback plan created
- ‚è≥ Waiting for E1-S6-v2 completion (2-3 min)
- üö® Rollback execution imminent if 3/3 failure confirmed
- üìã Decision criteria: Execute rollback if E1-S6-v2 fails with same pattern

**Next:** Monitor E1-S6-v2, execute rollback if fails, respawn 3 stories with OLD harness.
